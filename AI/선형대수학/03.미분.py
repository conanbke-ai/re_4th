# 미분


###################################################################################################################
# 실습 1

# -*- coding: utf-8 -*-
"""
미분 연습 문제 1 ~ 3번을 파이썬으로 정리한 코드입니다.

1. 단변수 함수의 미분식 출력
   a) f(x) = 3x^2
   b) f(x) = x^3 + 2x
   c) f(x) = 5x^4 - 3x^2 + 7

2. 다변수 함수 f(x, y) = 3x^2 + 2xy + y^2 의 편미분
   - x에 대한 편미분 식
   - y에 대한 편미분 식

3. f(x) = x^3 의 x=2 에서의 미분값을
   - 수치 미분(중심 차분)으로 계산
"""

# ===============================
# 1. 단변수 함수와 도함수 정의
# ===============================

# (1-a) f(x) = 3x^2
def f1(x):
    """f1(x) = 3x^2"""
    return 3 * x**2

def f1_prime(x):
    """
    f1'(x) = 6x  (수학적으로 직접 미분한 결과를 코드로 구현)
    """
    return 6 * x


# (1-b) f(x) = x^3 + 2x
def f2(x):
    """f2(x) = x^3 + 2x"""
    return x**3 + 2 * x

def f2_prime(x):
    """
    f2'(x) = 3x^2 + 2
    - x^3  ->  3x^2
    - 2x   ->  2
    """
    return 3 * x**2 + 2


# (1-c) f(x) = 5x^4 - 3x^2 + 7
def f3(x):
    """f3(x) = 5x^4 - 3x^2 + 7"""
    return 5 * x**4 - 3 * x**2 + 7

def f3_prime(x):
    """
    f3'(x) = 20x^3 - 6x
    - 5x^4 -> 20x^3
    - -3x^2 -> -6x
    - 상수 7의 미분은 0
    """
    return 20 * x**3 - 6 * x


# ===============================
# 2. 다변수 함수와 편미분 정의
# ===============================

def f_xy(x, y):
    """f(x, y) = 3x^2 + 2xy + y^2"""
    return 3 * x**2 + 2 * x * y + y**2

def df_dx(x, y):
    """
    x에 대한 편미분 ∂f/∂x
    - 3x^2     -> 6x
    - 2xy      -> 2y   (y는 상수 취급)
    - y^2      -> 0    (x와 무관)
    => ∂f/∂x = 6x + 2y
    """
    return 6 * x + 2 * y

def df_dy(x, y):
    """
    y에 대한 편미분 ∂f/∂y
    - 3x^2     -> 0    (y와 무관)
    - 2xy      -> 2x
    - y^2      -> 2y
    => ∂f/∂y = 2x + 2y
    """
    return 2 * x + 2 * y


# ===============================
# 3. 수치 미분 (중심 차분)
# ===============================

def numerical_derivative(f, x, h=1e-5):
    """
    주어진 함수 f에 대해, x에서의 수치 미분 값을
    '중심 차분' 방식으로 근사 계산한다.

    f'(x) ≈ ( f(x + h) - f(x - h) ) / (2h)

    - h는 아주 작은 양수 (기본값: 1e-5)
    - h가 너무 크면 오차가 커지고, 너무 작으면 부동소수점 오차가 커질 수 있음
    """
    return (f(x + h) - f(x - h)) / (2 * h)


# ===============================
# 메인 실행부: 결과 출력
# ===============================
if __name__ == "__main__":
    # 1번: 도함수 식과 예시 값 출력
    x_value = 2  # 예시로 x=2에서 값 확인

    print("=== 1. 단변수 함수 미분 ===")
    print(f"f1(x) = 3x^2,    f1'(x) = 6x  → f1'({x_value}) = {f1_prime(x_value)}")
    print(f"f2(x) = x^3+2x,  f2'(x) = 3x^2+2  → f2'({x_value}) = {f2_prime(x_value)}")
    print(f"f3(x) = 5x^4-3x^2+7,  f3'(x) = 20x^3-6x  → f3'({x_value}) = {f3_prime(x_value)}")
    print()

    # 2번: 다변수 편미분 (예시: x=1, y=2에서 값 확인)
    x0, y0 = 1, 2
    print("=== 2. f(x, y) = 3x^2 + 2xy + y^2 의 편미분 ===")
    print("∂f/∂x = 6x + 2y  → ∂f/∂x(1,2) =", df_dx(x0, y0))
    print("∂f/∂y = 2x + 2y  → ∂f/∂y(1,2) =", df_dy(x0, y0))
    print()

    # 3번: f(x) = x^3 의 x=2에서의 수치 미분
    def f(x):
        return x**3

    x0 = 2
    deriv_num = numerical_derivative(f, x0)
    deriv_exact = 3 * x0**2  # 이론값 3x^2

    print("=== 3. 수치 미분으로 f(x)=x^3 의 x=2에서의 도함수 값 ===")
    print("수치 미분값 (중심 차분):", deriv_num)
    print("이론적인 정확한 값   :", deriv_exact)
    print("오차(수치 - 이론)    :", deriv_num - deriv_exact)
